stages:
    - services
    - triggers

# POSTGRES DATABASE

start_database:
    stage: services
    script:
        - docker-compose -f docker-compose.ci.yml up -d postgres-db

# RABBITMQ MESSAGE BROKER

start_rabbitmq:
    stage: services
    script:
        - docker-compose -f docker-compose.ci.yml up -d rabbitmq

# FASTAPI SERVER

trigger_server:
    stage: triggers
    trigger:
        include: odk-api/.gitlab-ci.yml
    rules:
        - changes:
            - docker-compose.ci.yml
            - odk-api/**/*

# VUE PWA

trigger_server:
    stage: triggers
    trigger:
        include: odk-app/.gitlab-ci.yml
    rules:
        - changes:
            - docker-compose.ci.yml
            - odk-app/**/*